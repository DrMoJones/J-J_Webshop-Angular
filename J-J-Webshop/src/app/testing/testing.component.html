<h2>Admin page</h2>

<div *ngIf="!selectedGenre">
    <form #genreFormIns="ngForm" (ngSubmit)="AddOrUpdateGenre(0, name.value)">
        <label for="name">Name for NEW genre</label>
        <div>
            <input type="text" name="genreName" id="genreName" required [(ngModel)]="genreModel.genreName"
                #name="ngModel">
            <div [hidden]="name.valid || name.pristine">
                Name is required
            </div>
        </div>
        <button type="submit" [disabled]="!genreFormIns.valid">Submit</button>
    </form>
</div>

<div *ngIf="selectedGenre">
    <form (ngSubmit)="AddOrUpdateGenre(selectedGenre.id, name.value)" #genreFormUpd="ngForm">
        <label for="genreName">UPDATE genre WITH id {{selectedGenre.id}}</label>
        <div>
            <input type="text" name="genre" id="genre" required [(ngModel)]="selectedGenre.genreName" #name="ngModel">
            <div [hidden]="name.valid || name.pristine">
                Name is required
            </div>
        </div>
        <button (click)="genreEditChangeFalse()">Cancel</button>
        <button type="submit" [disabled]="!genreFormUpd.valid">Submit</button>
    </form>
</div>

<ul>
    <li *ngFor="let genre of genres" (click)="onSelectGenre(genre);genreEditChangeTrue();">
        Genre: {{genre.genreName}}
        <button (click)="Delete(genre);">Delete</button>
        <br>
    </li>
</ul>

<div *ngIf="!selectedProduct">
    <form (ngSubmit)="AddOrUpdateProduct(productModel)" #ProductFormIns="ngForm">
        <label for="AddProduct"> Add new product with genre</label>
        <div>
            Product Name: <input type="text" name="ProductName" id="ProductName" required
                [(ngModel)]="productModel.name" #ProductName="ngModel">
            <div [hidden]="ProductName.valid || ProductName.pristine">
                Name is required
            </div>
            <br>
            Product Price: <input type="number" name="ProductPrice" id="ProductPrice" required
                [(ngModel)]="productModel.price" #price="ngModel">
            <div [hidden]="price.valid || price.pristine">
                Price is required
            </div>
            <br>
            Product Description: <input type="text" name="ProductDescription" id="ProductDescription" required
                [(ngModel)]="productModel.description" #description="ngModel">
            <div [hidden]="description.valid || description.pristine">
                Description is required
            </div>
            <br>

            <div>
                <label for="Genre">Genres: </label>
                <select id="Genre" required [(ngModel)]="productModel.genreId" name="genre" #genre="ngModel">
                    <option *ngFor="let genre of genres" [ngValue]="genre.id">
                        {{genre.genreName}}
                    </option>
                </select>
                <div [hidden]="genre.valid || genre.pristine">
                    You need to pick a valid genre
                </div>
            </div>
            Product Stock: <input type="number" name="ProductStock" id="ProductStock" required
                [(ngModel)]="productModel.stock" #ProductStock="ngModel">
            <div [hidden]="ProductStock.valid || ProductStock.pristine">
                how much is in stock
            </div>
            <br>

        </div>
        <br>

        <button type="submit" [disabled]="!ProductFormIns.valid">Submit</button>

    </form>
</div>


<div *ngIf="selectedProduct">
    <form (ngSubmit)="AddOrUpdateProduct(selectedProduct)" #productFormUpd="ngForm">
        <label for="Update">Updating product with id: {{selectedProduct.id}}</label>
        <div>
            Product name: <input type="text" name="ProductName" id="ProductName" required
                [(ngModel)]="selectedProduct.name" #productName>
            <div [hidden]="productName.valid || productName.pristine">
                Name is required
            </div>
        </div>

        <br>

        Product Price: <input type="number" name="ProductPrice" id="ProductPrice" required
            [(ngModel)]="selectedProduct.price" #price="ngModel">
        <div [hidden]="price.valid || price.pristine">
            Price is required
        </div>

        <br>

        Product Description: <input type="text" name="ProductDescription" id="ProductDescription" required
            [(ngModel)]="selectedProduct.description" #description="ngModel">
        <div [hidden]="description.valid || description.pristine">
            Description is required
        </div>

        <br>

        <div>
            <label for="Genre">Genres: </label>
            <select id="Genre" required [(ngModel)]="selectedProduct.genreId" name="genre" #genre="ngModel">
                <option *ngFor="let genre of genres" [ngValue]="genre.id">
                    {{genre.genreName}}
                </option>
            </select>
        </div>
        Product Stock: <input type="number" name="ProductStock" id="ProductStock" required
            [(ngModel)]="selectedProduct.stock" #ProductStock="ngModel">
        <div [hidden]="ProductStock.valid || ProductStock.pristine">
            how much is in stock
        </div>

        <br>

        <br>

        <button (click)="ProductEditFalse()"> Cancel</button>
        <button type="submit" [disabled]="!productFormUpd.valid">Submit</button>
    </form>
</div>



<ul>
    <li *ngFor="let product of products" (click)="OnSelectProduct(product);ProductEditTrue()">
        <span>
            {{product.name}},
        </span>
        {{product.price}},
        {{product.description}},
        {{product.genreId}},
        remaining stock = {{product.stock}},
        {{product.genre.genreName}}
        <button (click)="DeleteProduct(product); ">Delete</button>
        <br>
    </li>
</ul>